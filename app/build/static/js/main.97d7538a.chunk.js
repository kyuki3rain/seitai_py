(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{15:function(t,e,n){},37:function(t,e,n){},46:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n(1),o=n.n(i),a=n(17),s=n.n(a),c=(n(37),function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,47)).then((function(e){var n=e.getCLS,r=e.getFID,i=e.getFCP,o=e.getLCP,a=e.getTTFB;n(t),r(t),i(t),o(t),a(t)}))}),p=(n(15),n(5)),u=n.n(p),l=n(12),h=n(6),d=window.eel,f=["application","calibration","create_data"],b=["serial","test"],v=function(t){var e=t.setMode,n=Object(i.useState)(),o=Object(h.a)(n,2),a=o[0],s=o[1],c=Object(i.useState)(),p=Object(h.a)(c,2),v=p[0],j=p[1],O=Object(i.useState)("test"),m=Object(h.a)(O,2),g=m[0],y=m[1],x=Object(i.useState)("application"),k=Object(h.a)(x,2),w=k[0],S=k[1],C=Object(i.useState)(3),N=Object(h.a)(C,2),I=N[0],B=N[1],J=Object(i.useState)(10),P=Object(h.a)(J,2),A=P[0],F=P[1],M=Object(i.useState)(""),z=Object(h.a)(M,2),_=z[0],G=z[1],U=Object(i.useState)(null),W=Object(h.a)(U,2),L=W[0],T=W[1],R=function(){var t=Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.get_ports()();case 2:e=t.sent,s(e),j(e[0]);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),E=function(){var t=Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.get_threshold()();case 2:e=t.sent,F(e);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),H=function(){var t=Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.get_import_file_name()();case 2:e=t.sent,G(e);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(i.useEffect)((function(){R(),E(),H(),T(null)}),[]),a?Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)("div",{class:"column",style:{height:450},children:[Object(r.jsx)("h1",{style:{margin:0},children:"Options"}),!1===L?Object(r.jsx)("div",{style:{color:"red"},children:"\u6b63\u3057\u304f\u52d5\u4f5c\u3057\u306a\u3044\u8a2d\u5b9a\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u3082\u3046\u4e00\u5ea6\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"}):Object(r.jsx)(r.Fragment,{}),Object(r.jsxs)("div",{class:"row",style:{width:600},children:[Object(r.jsx)("div",{children:"port select"}),Object(r.jsx)("select",{value:v,class:"input",onChange:function(t){j(t.target.value)},children:a.map((function(t){return Object(r.jsx)("option",{value:t,children:t})}))})]}),Object(r.jsxs)("div",{class:"row",style:{width:600},children:[Object(r.jsx)("div",{class:"title",children:"datamode select"}),Object(r.jsx)("select",{value:g,class:"input",onChange:function(t){y(t.target.value)},children:b.map((function(t){return Object(r.jsx)("option",{value:t,children:t})}))})]}),Object(r.jsxs)("div",{class:"row",style:{width:600},children:[Object(r.jsx)("div",{class:"title",children:"mode select"}),Object(r.jsx)("select",{value:w,class:"input",onChange:function(t){S(t.target.value)},children:f.map((function(t){return Object(r.jsx)("option",{value:t,children:t})}))})]}),Object(r.jsxs)("div",{class:"row",style:{width:600},children:[Object(r.jsx)("div",{class:"title",children:"data length"}),Object(r.jsx)("input",{type:"textarea",class:"input",value:I,onChange:function(t){B(Number(t.target.value))}})]}),Object(r.jsxs)("div",{class:"row",style:{width:600},children:[Object(r.jsx)("div",{class:"title",children:"threshold"}),Object(r.jsx)("input",{type:"textarea",class:"input",value:A,onChange:function(t){F(Number(t.target.value))}})]}),Object(r.jsxs)("div",{class:"row",style:{width:600},children:[Object(r.jsx)("div",{class:"title",children:"file_name"}),Object(r.jsx)("input",{type:"textarea",class:"input_long",value:_,onChange:function(t){G(t.target.value)}})]}),Object(r.jsx)("button",{onClick:function(){var t=(console.log("validate start!"),console.log(v,g,w,_,A),!(!v&&"serial"===g)&&("create_data"!==w||"test"!==g)&&!!I&&!("create_data"===w&&!_)&&!("test"===g&&!_)&&!(!A&&"application"===w));console.log(t),T(t),t?(d.set_args({port:v,data_mode:g,mode:w,data_length:I,threshold:A,import_file_name:_}),e(w)):console.log("validate error!")},style:{height:45,width:300},children:"start"})]})}):Object(r.jsx)("div",{children:"loading..."})},j=n(7),O=n(8),m=n(11),g=n(10),y=n(9),x=n(3),k=n(4),w="INITIALIZE",S="GamePlay",C="IntervalId",N="advanceId",I="waiteTime",B="blockRotateChange",J="blockChange",P="mapUpdate",A="addMino",F="pullMino",M="setPosition",z="leftPosition",_="rightPosition",G="updateMino",U="advancePosition",W="preBlock",L="resetPreBlock",T="setNextBlock",R="setHoldBlock",E="addScore",H="timeUpdate",D="timeReset",Z="flameUpdate",q="changeOption",K="changeSpeed",Q="predictPosition",V="dropPosition",X="changeFlame",Y="changeWait",$="changePosition",tt=function(){return{type:w}},et=function(){return{type:S,payload:0}},nt=function(t){return{type:C,payload:t}},rt=function(t){return{type:N,payload:t}};function it(){var t=Object(x.a)(["\n    display:flex;\n    flex-direction:row;\n    /* padding:0 10px; */\n"]);return it=function(){return t},t}function ot(){var t=Object(x.a)(["\n    width:2vw;\n    height:2vw;\n    border:1px "," solid;\n    box-sizing:border-box;\n    /* margin:-1px; */\n    background-color:",";\n"]);return ot=function(){return t},t}function at(){var t=Object(x.a)(["\n    width:20vw;\n    margin:0vw 2vw;\n    height:calc(40vw);\n    border:4px #112d4e solid;\n"]);return at=function(){return t},t}var st=k.a.div(at()),ct=k.a.div(ot(),(function(t){return t.pred}),(function(t){return t.color})),pt=k.a.div(it()),ut=function(t){Object(m.a)(n,t);var e=Object(g.a)(n);function n(){return Object(j.a)(this,n),e.apply(this,arguments)}return Object(O.a)(n,[{key:"returnColor",value:function(t){switch(t){case 0:return"white";case 1:return"#ff2800";case 2:return"#35a16b";case 3:return"#ff9900";case 4:return"#0041ff";case 5:return"#faf500";case 6:return"#66ccff";case 7:return"#9a0079";case 8:return"#dbe2ef";default:return"black"}}},{key:"returnColor2",value:function(t,e){switch(0!=e&&(t=8),t){case 0:return"white";case 1:return"#ff2800";case 2:return"#35a16b";case 3:return"#ff9900";case 4:return"#0041ff";case 5:return"#faf500";case 6:return"#66ccff";case 7:return"#9a0079";case 8:return"#dbe2ef";default:return"black"}}},{key:"render",value:function(){for(var t=[],e=0;e<20;e++){for(var n=[],i=0;i<10;i++)n.push(Object(r.jsx)(ct,{color:this.returnColor(this.props.map[e][i]),pred:this.returnColor2(this.props.predictPos[e][i],this.props.map[e][i])},i));t.push(Object(r.jsx)(pt,{children:n},e))}return Object(r.jsx)(st,{children:t})}}]),n}(o.a.Component),lt=Object(y.b)((function(t){return{map:t.map,predictPos:t.predictPos}}),{})(ut);function ht(){var t=Object(x.a)(["\n    width:4vw;\n    height:3vw;\n    font-size:2vw;\n    background-color:transparent;\n    border:none;\n    color:#f9f7f7;\n    text-align:center;\n"]);return ht=function(){return t},t}function dt(){var t=Object(x.a)(["\n    width:16vw;\n    height:3vw;\n"]);return dt=function(){return t},t}function ft(){var t=Object(x.a)(["\n    width:8vw;\n    height:3vw;\n    font-size:2vw;\n    color:#f9f7f7;\n    text-align:center;\n"]);return ft=function(){return t},t}function bt(){var t=Object(x.a)(["\n    width:32vw;\n    height:4vw;\n    font-size:3vw;\n    margin:1vw auto;\n    box-sizing:border-box;\n    display:flex;\n    justify-content:space-around;\n"]);return bt=function(){return t},t}function vt(){var t=Object(x.a)(["\n    display:",";\n    padding:1vw 0;\n"]);return vt=function(){return t},t}function jt(){var t=Object(x.a)(["\n    display:",";\n    padding:2vw 0;\n"]);return jt=function(){return t},t}function Ot(){var t=Object(x.a)(["\n    width:20vw;\n    height:3.5vw;\n    font-size:3vw;\n    margin:1vw auto;\n    box-sizing:border-box;\n    :hover{\n        border-bottom:0.2vw #f9f7f7 solid;\n    }\n"]);return Ot=function(){return t},t}function mt(){var t=Object(x.a)(["\n    width:36vw;\n    height:24vw;\n    background-color:#112d4e;\n    position:absolute;\n    top:10vw;\n    opacity:0.9;\n    color:#f9f7f7;\n    text-align:center;\n    /* padding:4vw 0; */\n    box-sizing:border-box;\n    display:",";\n    /* padding:2vw 0 5vw; */\n"]);return mt=function(){return t},t}var gt=k.a.div(mt(),(function(t){return t.f})),yt=k.a.div(Ot()),xt=k.a.div(jt(),(function(t){return t.f})),kt=k.a.div(vt(),(function(t){return t.f})),wt=k.a.div(bt()),St=k.a.div(ft()),Ct=k.a.input(dt()),Nt=k.a.input(ht()),It=[[1,[0,0],[0,0],[0,0],[0,0]],[4,[0,0],[-1,-1],[-1,0],[0,1]],[4,[0,0],[-1,0],[-1,1],[0,-1]],[4,[0,0],[0,1],[0,-1],[-1,1]],[4,[0,0],[0,1],[0,-1],[-1,-1]],[1,[0,0],[0,1],[-1,0],[-1,1]],[4,[0,0],[0,1],[0,-1],[0,2]],[4,[0,0],[0,1],[-1,0],[0,-1]]],Bt=[1,2,3,4,5,6,7],Jt=Bt.length,Pt=[[[0,0],[0,-1],[1,-1],[-2,0],[-2,-1]],[[0,0],[0,1],[1,1],[-2,0],[-2,1]],[[0,0],[0,-1],[-1,-1],[2,0],[2,-1]],[[0,0],[0,-1],[-1,-1],[2,0],[2,-1]],[[0,0],[0,-1],[1,-1],[-2,0],[-2,-1]],[[0,0],[0,1],[1,1],[-2,0],[-2,1]],[[0,0],[0,1],[-1,1],[2,0],[2,1]],[[0,0],[0,1],[-1,1],[2,0],[2,1]]],At=[[[0,0],[0,-2],[0,1],[2,1],[-1,-2]],[[0,0],[0,2],[0,-1],[-1,2],[2,-1]],[[0,0],[0,-2],[0,1],[1,-2],[-2,1]],[[0,0],[0,1],[0,-2],[2,1],[-1,-2]],[[0,0],[0,-1],[0,2],[-2,-1],[1,2]],[[0,0],[0,1],[0,-2],[1,-2],[-2,1]],[[0,0],[0,2],[0,-1],[-1,2],[-2,-1]],[[0,0],[0,-1],[0,2],[-2,-1],[1,2]]],Ft=function(t){Object(m.a)(n,t);var e=Object(g.a)(n);function n(t){var r;return Object(j.a)(this,n),(r=e.call(this,t)).count=0,r.holdCount=0,r.flameCount=0,r.state={option:0},r.line=0,r.stopping=0,r.clear=function(){},r}return Object(O.a)(n,[{key:"blockRotate",value:function(t){for(var e=JSON.parse(JSON.stringify(this.props.map)),n=JSON.parse(JSON.stringify(this.props.preBlock)),r=new Array(4),i=(this.props.rotate+4+t)%It[this.props.minoNum][0],o=0;o<4;o++)n[o][0]>=0&&(e[n[o][0]][n[o][1]]=0);for(var a=0;a<4;a++){r[a]=JSON.parse(JSON.stringify(It[this.props.minoNum][a+1]));for(var s=0;s<i;s++)r[a]=[r[a][1],-r[a][0]],6==this.props.minoNum&&r[a][0]++}var c,p,u=0;if(6==this.props.minoNum)for(var l=0;l<5;l++){u=0,c=this.props.position[0]+At[2*i+(t<0)?1:0][l][0],p=this.props.position[1]+At[2*i+(t<0)?1:0][l][1];for(var h=0;h<4;h++){if(r[h][0]+c>=20||r[h][0]+c<0||r[h][1]+p>=10||r[h][1]+p<0){u=1;break}if(0!=e[r[h][0]+c][r[h][1]+p]){u=1;break}}if(0==u)break}else for(var d=0;d<5;d++){u=0,c=this.props.position[0]+Pt[2*i-(t-1)/2][d][0],p=this.props.position[1]+Pt[2*i-(t-1)/2][d][1];for(var f=0;f<4;f++){if(r[f][0]+c>=20||r[f][0]+c<0||r[f][1]+p>=10||r[f][1]+p<0){u=1;break}if(0!=e[r[f][0]+c][r[f][1]+p]){u=1;break}}if(0==u)break}0==u&&(this.props.changePosition([c,p]),this.props.blockRotateChange(i),this.props.blockChange(r),this.predict(this.props.block))}},{key:"shaffle",value:function(){for(;Jt;){var t=Math.floor(Math.random()*Jt),e=Bt[--Jt];Bt[Jt]=Bt[t],Bt[t]=e}return Bt}},{key:"blockSet",value:function(){this.props.setPosition(),this.props.mino.length<14&&this.props.addMino(),this.props.blockRotateChange(0),this.props.resetPreBlock(),this.props.waitTime(0),this.holdCount=0;for(var t=new Array(4),e=this.props.mino,n=e.shift(),r=0;r<4;r++)t[r]=It[n][r+1];this.props.blockChange(t),this.props.pullMino(e),this.props.updateMino(n),this.predict(t)}},{key:"Hold",value:function(){this.props.setHoldBlock(),this.blockSet(),this.nextSet(),this.holdCount=1}},{key:"gameCheck",value:function(){var t=JSON.parse(JSON.stringify(this.props.map)),e=new Array(10).fill(0);if(0!=t[0][4]&&0!=t[0][5])this.pauseGame();else{for(var n=0,r=0;r<20;r++){for(var i=0,o=0;o<10;o++)if(0==t[r][o]){i=1;break}0==i&&(n++,t.splice(r,1),t.unshift(e),this.props.addScore(n),this.line++,this.line>=10&&(this.props.changeSpeed(this.props.advanceSpeed+3),this.line=0))}this.props.mapUpdate(t)}}},{key:"nextSet",value:function(){for(var t=new Array(5),e=0;e<5;e++){t[e]=new Array(4);for(var n=0;n<4;n++)t[e][n]=new Array(4).fill(0);for(var r=0;r<4;r++)e<4?t[e][It[this.props.mino[e]][r+1][0]+1][It[this.props.mino[e]][r+1][1]+1]=this.props.mino[e]:t[e][It[this.props.holdBlock][r+1][0]+1][It[this.props.holdBlock][r+1][1]+1]=this.props.holdBlock}this.props.setNextBlock(t)}},{key:"positionControl",value:function(){for(var t=JSON.parse(JSON.stringify(this.props.map)),e=JSON.parse(JSON.stringify(this.props.preBlock)),n=0;n<4;n++)e[n][0]>=0&&(t[e[n][0]][e[n][1]]=0);for(var r=0,i=0;i<4;i++){if(!(this.props.position[0]+this.props.block[i][0]+1<20)){r=1;break}if(0!=t[this.props.position[0]+this.props.block[i][0]+1][this.props.position[1]+this.props.block[i][1]]){r=1;break}}0==r?(this.props.advancePosition(),this.count=0):this.props.waitTime(this.props.wait+Math.floor(this.stopping/5)+1)}},{key:"Loop",value:function(){if(this.props.wait>=this.props.maxWait)this.props.waitTime(0),this.gameCheck(),this.blockSet(),this.nextSet();else{for(var t=JSON.parse(JSON.stringify(this.props.map)),e=JSON.parse(JSON.stringify(this.props.preBlock)),n=0,r=0;r<4;r++)e[r][0]==this.props.position[0]+this.props.block[r][0]&&e[r][1]==this.props.position[1]+this.props.block[r][1]||(n=1),e[r][0]>=0&&(t[e[r][0]][e[r][1]]=0);0==n?this.stopping+=1:this.stopping=0;for(var i=0;i<4;i++)this.props.position[0]+this.props.block[i][0]>=0&&(t[this.props.position[0]+this.props.block[i][0]][this.props.position[1]+this.props.block[i][1]]=this.props.minoNum),e[i]=[this.props.position[0]+this.props.block[i][0],this.props.position[1]+this.props.block[i][1]];this.count++,this.props.updatePreBlock(e),this.props.mapUpdate(t)}this.flameCount++,this.count>=this.props.gameSpeed/this.props.advanceSpeed&&this.positionControl()}},{key:"time",value:function(){this.props.timeUpdate([this.props.time[0]+Math.floor((this.props.time[1]+1)/60),(this.props.time[1]+1)%60]),this.props.flameUpdate(this.flameCount),this.flameCount=0}},{key:"startGame",value:function(){this.line=0,this.props.initialize(),this.props.makeGame(),this.props.waitTime(this.props.maxWait);var t=setInterval(this.Loop.bind(this),1e3/this.props.gameSpeed),e=setInterval(this.time.bind(this),1e3);this.props.setIntervalId(t),this.props.setAdvanceId(e)}},{key:"stopGame",value:function(){this.props.makeGame();var t=setInterval(this.Loop.bind(this),1e3/this.props.gameSpeed),e=setInterval(this.time.bind(this),1e3);this.props.setIntervalId(t),this.props.setAdvanceId(e)}},{key:"pauseGame",value:function(){this.props.resetGame(),clearInterval(this.props.intervalId),clearInterval(this.props.advanceId),this.props.setIntervalId(0),this.props.setAdvanceId(0)}},{key:"serialCheck",value:function(t){if(t){if(console.log(t),1===t[0]&&0===t[1]&&1===t[2]&&5!=this.props.minoNum&&this.blockRotate(-1),0===t[0]&&1===t[1]&&1===t[2]&&5!=this.props.minoNum&&this.blockRotate(1),0===t[0]&&0===t[1]&&1===t[2]&&0==this.holdCount){for(var e=JSON.parse(JSON.stringify(this.props.map)),n=JSON.parse(JSON.stringify(this.props.preBlock)),r=0;r<4;r++)n[r][0]>=0&&(e[n[r][0]][n[r][1]]=0);this.props.mapUpdate(e),this.Hold()}if(1===t[0]&&1===t[1]&&0===t[2]&&(this.count+=10),1===t[0]&&0===t[1]&&0===t[2]){for(var i=JSON.parse(JSON.stringify(this.props.map)),o=JSON.parse(JSON.stringify(this.props.preBlock)),a=0;a<4;a++)o[a][0]>=0&&(i[o[a][0]][o[a][1]]=0);for(var s=0,c=0;c<4;c++)this.props.position[1]+this.props.block[c][1]-1>=0?0!=i[this.props.position[0]+this.props.block[c][0]][this.props.position[1]+this.props.block[c][1]-1]&&(s=1):s=1;0==s&&(this.props.leftPosition(),this.predict(this.props.block))}if(0===t[0]&&1===t[1]&&0===t[2]){for(var p=JSON.parse(JSON.stringify(this.props.map)),u=JSON.parse(JSON.stringify(this.props.preBlock)),l=0;l<4;l++)u[l][0]>=0&&(p[u[l][0]][u[l][1]]=0);for(var h=0,d=0;d<4;d++)this.props.position[1]+this.props.block[d][1]+1<10?0!=p[this.props.position[0]+this.props.block[d][0]][this.props.position[1]+this.props.block[d][1]+1]&&(h=1):h=1;0==h&&(this.props.rightPosition(),this.predict(this.props.block))}1===t[0]&&1===t[1]&&1===t[2]&&(this.props.dropPosition(),this.props.waitTime(this.props.maxWait-5))}}},{key:"keyCheck",value:function(t){if(console.log(this.props.gamePlay),27==t.keyCode&&(1==this.props.gamePlay?this.pauseGame():0==this.props.gamePlay&&this.stopGame()),65==t.keyCode&&5!=this.props.minoNum&&this.blockRotate(-1),68==t.keyCode&&5!=this.props.minoNum&&this.blockRotate(1),69==t.keyCode&&0==this.holdCount){for(var e=JSON.parse(JSON.stringify(this.props.map)),n=JSON.parse(JSON.stringify(this.props.preBlock)),r=0;r<4;r++)n[r][0]>=0&&(e[n[r][0]][n[r][1]]=0);this.props.mapUpdate(e),this.Hold()}if(40==t.keyCode&&(this.count+=5),37==t.keyCode){for(var i=JSON.parse(JSON.stringify(this.props.map)),o=JSON.parse(JSON.stringify(this.props.preBlock)),a=0;a<4;a++)o[a][0]>=0&&(i[o[a][0]][o[a][1]]=0);for(var s=0,c=0;c<4;c++)this.props.position[1]+this.props.block[c][1]-1>=0?0!=i[this.props.position[0]+this.props.block[c][0]][this.props.position[1]+this.props.block[c][1]-1]&&(s=1):s=1;0==s&&(this.props.leftPosition(),this.predict(this.props.block))}if(39==t.keyCode){for(var p=JSON.parse(JSON.stringify(this.props.map)),u=JSON.parse(JSON.stringify(this.props.preBlock)),l=0;l<4;l++)u[l][0]>=0&&(p[u[l][0]][u[l][1]]=0);for(var h=0,d=0;d<4;d++)this.props.position[1]+this.props.block[d][1]+1<10?0!=p[this.props.position[0]+this.props.block[d][0]][this.props.position[1]+this.props.block[d][1]+1]&&(h=1):h=1;0==h&&(this.props.rightPosition(),this.predict(this.props.block))}38===t.keyCode&&(this.props.dropPosition(),this.props.waitTime(this.props.maxWait-5))}},{key:"changeMenu",value:function(){this.option,this.setState({option:(this.state.option+1)%2})}},{key:"predict",value:function(t){for(var e,n=JSON.parse(JSON.stringify(this.props.map)),r=JSON.parse(JSON.stringify(this.props.preBlock)),i=0;i<4;i++)r[i][0]>=0&&(n[r[i][0]][r[i][1]]=0);var o=this.props.position[0];do{o++,e=0;for(var a=0;a<4;a++){if(!(o+t[a][0]<20)){e=1;break}if(0!=n[o+t[a][0]][this.props.position[1]+t[a][1]]){e=1;break}}}while(0==e);o--,this.props.predictPosition(o)}},{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.keyCheck.bind(this)),console.log(this.props.setFlagsFunction),this.clear=this.props.setFlagsFunction(this.serialCheck.bind(this))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.keyCheck.bind(this))}},{key:"render",value:function(){var t=this;return Object(r.jsxs)(gt,{f:this.props.gamePlay?"none":"block",children:[Object(r.jsxs)(xt,{f:this.state.option?"none":"block",children:[Object(r.jsx)(yt,{onClick:this.startGame.bind(this),children:"\u6700\u521d\u304b\u3089"}),Object(r.jsx)(yt,{onClick:this.stopGame.bind(this),children:"\u9014\u4e2d\u304b\u3089"}),Object(r.jsx)(yt,{onClick:this.changeMenu.bind(this),children:"\u8a2d\u5b9a"}),Object(r.jsx)(yt,{onClick:function(){t.clear(),t.props.setMode("init")},children:"\u623b\u308b"})]}),Object(r.jsxs)(kt,{f:this.state.option?"block":"none",children:[Object(r.jsxs)(wt,{children:[Object(r.jsx)(St,{children:"flame"}),Object(r.jsx)(Nt,{type:"text",value:this.props.gameSpeed,onChange:function(e){return t.props.changeFlame(e.target.value)}}),Object(r.jsx)(Ct,{type:"range",value:this.props.gameSpeed,min:1,max:30,step:1,onChange:function(e){return t.props.changeFlame(e.target.value)}})]}),Object(r.jsxs)(wt,{children:[Object(r.jsx)(St,{children:"\u7336\u4e88"}),Object(r.jsx)(Nt,{type:"text",value:this.props.maxWait,onChange:function(e){return t.props.changeWait(e.target.value)}}),Object(r.jsx)(Ct,{type:"range",value:this.props.maxWait,min:1,max:100,step:1,onChange:function(e){return t.props.changeWait(e.target.value)}})]}),Object(r.jsxs)(wt,{children:[Object(r.jsx)(St,{children:"\u30ec\u30d9\u30eb"}),Object(r.jsx)(Nt,{type:"text",value:this.props.advanceSpeed/3,onChange:function(e){return t.props.changeSpeed(3*e.target.value)}}),Object(r.jsx)(Ct,{type:"range",value:this.props.advanceSpeed/3,min:1,max:15,step:1,onChange:function(e){return t.props.changeSpeed(3*e.target.value)}})]}),Object(r.jsx)(yt,{onClick:this.changeMenu.bind(this),children:"\u623b\u308b"})]})]})}}]),n}(o.a.Component),Mt=Object(y.b)((function(t){return t}),{leftPosition:function(){return{type:z}},rightPosition:function(){return{type:_}},makeGame:function(){return{type:S,payload:1}},resetGame:et,initialize:tt,setIntervalId:nt,waitTime:function(t){return{type:I,payload:t}},blockChange:function(t){return{type:J,payload:t}},blockRotateChange:function(t){return{type:B,payload:t}},mapUpdate:function(t){return{type:P,payload:t}},updatePreBlock:function(t){return{type:W,payload:t}},addMino:function(){return{type:A}},pullMino:function(t){return{type:F,payload:t}},setPosition:function(){return{type:M}},advancePosition:function(){return{type:U}},updateMino:function(t){return{type:G,payload:t}},resetPreBlock:function(){return{type:L}},setNextBlock:function(t){return{type:T,payload:t}},setAdvanceId:rt,setHoldBlock:function(t){return{type:R,payload:t}},addScore:function(t){return{type:E,payload:t}},timeUpdate:function(t){return{type:H,payload:t}},flameUpdate:function(t){return{type:Z,payload:t}},changeOption:function(){return{type:q}},changeSpeed:function(t){return{type:K,payload:t}},predictPosition:function(t){return{type:Q,payload:t}},dropPosition:function(){return{type:V}},changeFlame:function(t){return{type:X,payload:t}},changeWait:function(t){return{type:Y,payload:t}},changePosition:function(t){return{type:$,payload:t}}})(Ft);function zt(){var t=Object(x.a)(["\n    display:flex;\n    flex-direction:row;\n    padding:0 10px;\n"]);return zt=function(){return t},t}function _t(){var t=Object(x.a)(["\n    width:1.5vw;\n    height:1.5vw;\n    border:1px #dbe2ef solid;\n    box-sizing:border-box;\n    background-color:",";\n"]);return _t=function(){return t},t}function Gt(){var t=Object(x.a)(["\n    width:6vw;\n    height:3vw;\n    border:3px black solid;\n    box-sizing:border-box;\n    margin:0 0 0 0.75vw;\n    font-size:1.5vw;\n"]);return Gt=function(){return t},t}function Ut(){var t=Object(x.a)(["\n    width:7.5vw;\n    height:7.5vw;\n    border:3px black solid;\n    box-sizing:border-box;\n    margin:0 0 1vw;\n    padding:1vw 0 0;\n    background-color:#dbe2ef;\n"]);return Ut=function(){return t},t}function Wt(){var t=Object(x.a)(["\n    width:10vw;\n    height:40vw;\n"]);return Wt=function(){return t},t}var Lt=k.a.div(Wt()),Tt=k.a.div(Ut()),Rt=k.a.button(Gt()),Et=k.a.div(_t(),(function(t){return t.color})),Ht=k.a.div(zt()),Dt=function(t){Object(m.a)(n,t);var e=Object(g.a)(n);function n(){return Object(j.a)(this,n),e.apply(this,arguments)}return Object(O.a)(n,[{key:"pauseGame",value:function(){this.props.resetGame(),clearInterval(this.props.intervalId),clearInterval(this.props.advanceId),this.props.setIntervalId(0),this.props.setAdvanceId(0)}},{key:"returnColor",value:function(t){switch(t){case 0:return"transparent";case 1:return"#ff2800";case 2:return"#35a16b";case 3:return"#ff9900";case 4:return"#0041ff";case 5:return"#faf500";case 6:return"#66ccff";case 7:return"#9a0079";default:return"black"}}},{key:"color",value:function(t){for(var e=this.props.blockBox,n=0;n<4;n++)e[It[this.props.mino[t]][n+1][0]+1][It[this.props.mino[t]][n+1][1]+1]=this.props.mino[t];this.props.setNextBlock(e)}},{key:"render",value:function(){for(var t=[],e=0;e<4;e++){for(var n=[],i=0;i<4;i++){for(var o=[],a=0;a<4;a++)o.push(Object(r.jsx)(Et,{color:this.returnColor(this.props.blockBox[e][i][a])},a));n.push(Object(r.jsx)(Ht,{children:o},i))}t.push(Object(r.jsx)(Tt,{children:n},e))}return Object(r.jsxs)(Lt,{children:[t,Object(r.jsx)(Rt,{onClick:this.pauseGame.bind(this),children:"pause"})]})}}]),n}(o.a.Component),Zt=Object(y.b)((function(t){return{intervalId:t.intervalId,mino:t.mino,blockBox:t.blockBox,advanceId:t.advanceId}}),{setIntervalId:nt,resetGame:et,setAdvanceId:rt})(Dt);function qt(){var t=Object(x.a)(["\n    display:flex;\n    flex-direction:row;\n    padding:0 10px;\n"]);return qt=function(){return t},t}function Kt(){var t=Object(x.a)(["\n    width:2vw;\n    height:2vw;\n    border:1px #dbe2ef solid;\n    box-sizing:border-box;\n    background-color:",";\n"]);return Kt=function(){return t},t}function Qt(){var t=Object(x.a)(["\n    width:10vw;\n    height:10vw;\n    border:3px black solid;\n    box-sizing:border-box;\n    margin:0;\n    padding:1vw 0 0;\n    background-color:#dbe2ef;\n"]);return Qt=function(){return t},t}var Vt=k.a.div(Qt()),Xt=k.a.div(Kt(),(function(t){return t.color})),Yt=k.a.div(qt()),$t=function(t){Object(m.a)(n,t);var e=Object(g.a)(n);function n(){return Object(j.a)(this,n),e.apply(this,arguments)}return Object(O.a)(n,[{key:"returnColor",value:function(t){switch(t){case 0:return"transparent";case 1:return"#ff2800";case 2:return"#35a16b";case 3:return"#ff9900";case 4:return"#0041ff";case 5:return"#faf500";case 6:return"#66ccff";case 7:return"#9a0079";default:return"black"}}},{key:"render",value:function(){for(var t=[],e=0;e<4;e++){for(var n=[],i=0;i<4;i++)n.push(Object(r.jsx)(Xt,{color:this.returnColor(this.props.blockBox[4][e][i])},i));t.push(Object(r.jsx)(Yt,{children:n},e))}return Object(r.jsx)(Vt,{children:t})}}]),n}(o.a.Component),te=Object(y.b)((function(t){return{blockBox:t.blockBox}}),{})($t),ee=n(29);function ne(){var t=Object(x.a)(["\n    color:white;\n    font-size:2.4vw;\n    margin:0vw 0;\n    text-align:center;\n"]);return ne=function(){return t},t}function re(){var t=Object(x.a)(["\n    height:25vw;\n    width:10vw;\n    border:3px black solid;\n    box-sizing:border-box;\n    display:flex;\n    flex-direction:column;\n    justify-content:center;\n"]);return re=function(){return t},t}var ie=k.a.div(re()),oe=k.a.div(ne());function ae(t){return("0"+t).slice(-2)}var se=function(t){Object(m.a)(n,t);var e=Object(g.a)(n);function n(t){return Object(j.a)(this,n),e.call(this,t)}return Object(O.a)(n,[{key:"render",value:function(){return Object(ee.a)(this.props),Object(r.jsxs)(ie,{children:[Object(r.jsx)(oe,{children:"Score"}),Object(r.jsx)(oe,{children:this.props.score}),Object(r.jsx)(oe,{children:"Time"}),Object(r.jsxs)(oe,{children:[ae(this.props.time[0]),":",ae(this.props.time[1])]}),Object(r.jsx)(oe,{children:"Frame"}),Object(r.jsx)(oe,{children:this.props.flame})]})}}]),n}(o.a.Component),ce=Object(y.b)((function(t){return{score:t.score,time:t.time,flame:t.flame}}),{})(se);function pe(){var t=Object(x.a)(["\n    text-decoration: line-through;\n"]);return pe=function(){return t},t}function ue(){var t=Object(x.a)(["\n    color:#112d4e;\n    font-size:2.4vw;\n    margin:1vw 0;\n"]);return ue=function(){return t},t}function le(){var t=Object(x.a)(["\n    width:25vw;\n    height:40vw;\n    box-sizing:border-box;\n    padding:0 0 0 8vw;\n    display:flex;\n    flex-direction:column;\n    justify-content:center;\n"]);return le=function(){return t},t}function he(){var t=Object(x.a)(["\n    width:25vw;\n    height:40vw;\n    padding:0 0 0 1vw;\n    box-sizing:border-box;\n    display:flex;\n    flex-direction:column;\n    justify-content:center;\n"]);return he=function(){return t},t}function de(){var t=Object(x.a)(["\n    width:10vw;\n    display:flex;\n    flex-direction:column;\n    justify-content:space-between;\n"]);return de=function(){return t},t}function fe(){var t=Object(x.a)(["\n    display:flex;\n    flex-direction:row;\n    justify-content:center;\n    width:50vw;\n    margin:40px auto 0;\n    position:relative;\n"]);return fe=function(){return t},t}for(var be=k.a.div(fe()),ve=k.a.div(de()),je=(k.a.div(he()),k.a.div(le()),k.a.div(ue())),Oe=(Object(k.a)(je)(pe()),function(t){Object(m.a)(n,t);var e=Object(g.a)(n);function n(){return Object(j.a)(this,n),e.apply(this,arguments)}return Object(O.a)(n,[{key:"componentWillUnmount",value:function(){this.props.initialize(),clearInterval(this.props.intervalId),clearInterval(this.props.advanceId),console.log("clear "+this.props.intervalId),console.log("clear "+this.props.advanceId)}},{key:"render",value:function(){return Object(r.jsxs)(be,{children:[Object(r.jsx)(Mt,{setFlagsFunction:this.props.setFlagsFunction,setMode:this.props.setMode}),Object(r.jsxs)(ve,{children:[Object(r.jsx)(te,{}),Object(r.jsx)(ce,{})]}),Object(r.jsx)(lt,{}),Object(r.jsx)(Zt,{})]})}}]),n}(o.a.Component)),me=Object(y.b)((function(t){return{intervalId:t.intervalId,advanceId:t.adviceId}}),{initialize:tt})(Oe),ge=n(19),ye=n(2),xe=new Array(21),ke=0;ke<20;ke++)xe[ke]=new Array(10).fill(0);xe[20]=new Array(10).fill(10);for(var we=new Array(21),Se=0;Se<20;Se++)we[Se]=new Array(10).fill(8);we[20]=new Array(10).fill(10);for(var Ce=new Array(4),Ne=0;Ne<4;Ne++)Ce[Ne]=new Array(2).fill(0);for(var Ie=new Array(4),Be=0;Be<4;Be++)Ie[Be]=new Array(2).fill(0);for(var Je=new Array(5),Pe=0;Pe<5;Pe++){Je[Pe]=new Array(4);for(var Ae=0;Ae<4;Ae++)Je[Pe][Ae]=new Array(4).fill(0)}function Fe(){for(var t=[1,2,3,4,5,6,7],e=t.length;e;){var n=Math.floor(Math.random()*e),r=t[--e];t[e]=t[n],t[n]=r}return t}var Me=new Array(2).fill(0),ze={gamePlay:0,map:xe,intervalId:0,advanceId:0,gameSpeed:30,advanceSpeed:3,mino:Fe().concat(Fe()),position:[0,4],block:Ce,rotation:0,wait:0,minoNum:0,preBlock:Ie,blockBox:Je,holdBlock:0,score:0,time:Me,flame:0,option:0,maxWait:100,predictPos:we,predict:[0,4]},_e=Object(ge.b)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ze,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case S:return Object(ye.a)(Object(ye.a)({},t),{},{gamePlay:e.payload});case C:return Object(ye.a)(Object(ye.a)({},t),{},{intervalId:e.payload});case N:return Object(ye.a)(Object(ye.a)({},t),{},{advanceId:e.payload});case I:return Object(ye.a)(Object(ye.a)({},t),{},{wait:e.payload});case P:return Object(ye.a)(Object(ye.a)({},t),{},{map:e.payload});case B:return Object(ye.a)(Object(ye.a)({},t),{},{rotate:e.payload});case J:return Object(ye.a)(Object(ye.a)({},t),{},{block:e.payload});case A:var n=t.mino.concat(Fe());return Object(ye.a)(Object(ye.a)({},t),{},{mino:n});case F:return Object(ye.a)(Object(ye.a)({},t),{},{mino:e.payload});case M:return Object(ye.a)(Object(ye.a)({},t),{},{position:[0,4]});case z:return Object(ye.a)(Object(ye.a)({},t),{},{position:[t.position[0],t.position[1]-1]});case _:return Object(ye.a)(Object(ye.a)({},t),{},{position:[t.position[0],t.position[1]+1]});case U:return Object(ye.a)(Object(ye.a)({},t),{},{position:[t.position[0]+1,t.position[1]]});case V:return Object(ye.a)(Object(ye.a)({},t),{},{position:t.predict});case $:return Object(ye.a)(Object(ye.a)({},t),{},{position:e.payload});case G:return Object(ye.a)(Object(ye.a)({},t),{},{minoNum:e.payload});case W:return Object(ye.a)(Object(ye.a)({},t),{},{preBlock:e.payload});case L:return Object(ye.a)(Object(ye.a)({},t),{},{preBlock:Ie});case T:return Object(ye.a)(Object(ye.a)({},t),{},{blockBox:e.payload});case E:return Object(ye.a)(Object(ye.a)({},t),{},{score:t.score+e.payload});case H:return Object(ye.a)(Object(ye.a)({},t),{},{time:e.payload});case D:return Object(ye.a)(Object(ye.a)({},t),{},{time:Me});case Z:return Object(ye.a)(Object(ye.a)({},t),{},{flame:e.payload});case q:return Object(ye.a)(Object(ye.a)({},t),{},{option:(t.option+1)%2});case K:return Object(ye.a)(Object(ye.a)({},t),{},{advanceSpeed:e.payload});case X:return Object(ye.a)(Object(ye.a)({},t),{},{gameSpeed:e.payload});case Y:return Object(ye.a)(Object(ye.a)({},t),{},{maxWait:e.payload});case Q:for(var r=JSON.parse(JSON.stringify(we)),i=0;i<4;i++)r[e.payload+t.block[i][0]][t.position[1]+t.block[i][1]]=t.minoNum;return Object(ye.a)(Object(ye.a)({},t),{},{predictPos:r,predict:[e.payload,t.position[1]]});case R:if(0==t.holdBlock)return Object(ye.a)(Object(ye.a)({},t),{},{mino:t.mino,holdBlock:t.minoNum});var o=t.mino;return o.unshift(t.holdBlock),Object(ye.a)(Object(ye.a)({},t),{},{mino:o,holdBlock:t.minoNum});case w:var a=Fe().concat(Fe());return Object(ye.a)(Object(ye.a)({},t),{},{gamePlay:0,map:xe,intervalId:0,advanceId:0,mino:a,position:[0,4],block:Ce,rotation:0,wait:0,minoNum:0,preBlock:Ie,blockBox:Je,holdBlock:0,score:0,time:Me,flame:0,option:0,predictPos:we,predict:[0,4],advanceSpeed:3});default:return t}})),Ge=function(t){Object(m.a)(n,t);var e=Object(g.a)(n);function n(){return Object(j.a)(this,n),e.apply(this,arguments)}return Object(O.a)(n,[{key:"render",value:function(){return Object(r.jsx)(y.a,{store:_e,children:Object(r.jsx)(me,{setFlagsFunction:this.props.setFlagsFunction,setMode:this.props.setMode})})}}]),n}(o.a.Component),Ue=n(31),We=n(20),Le=n(30),Te=n.n(Le),Re=function(t){return Object(r.jsx)(Te.a,{type:"line",options:{chart:{height:500,width:750,zoom:{enabled:!1},animations:{enabled:!0,easing:"linear",dynamicAnimation:{enabled:!0}}},xaxis:{type:"datetime",range:2},yaxis:{show:!1,min:0,max:200,labels:{formatter:function(t){return t.toFixed(0)}}}},series:t.dataList})},Ee=function(t,e,n){return t.length>50&&t.shift(),[].concat(Object(Ue.a)(t),[{x:e,y:n}])};var He=function(t){var e=t.setFlagsFunction,n=["a","b","c"].map((function(t){return{name:t,data:[]}})),o=Object(i.useState)(n),a=Object(h.a)(o,2),s=a[0],c=a[1],p=Object(i.useState)(),f=Object(h.a)(p,2),b=f[0],v=f[1],j=Object(i.useState)(100),O=Object(h.a)(j,2),m=O[0],g=O[1],y=function(){var t=Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.get_data()();case 2:e=t.sent,console.log(e),c(s.map((function(t,n){return{name:t.name,data:Ee(t.data,e[0],e[n+1])}})));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(i.useEffect)((function(){var t=e(v);return g(100),function(){t(),g(null)}}),[]),Object(We.a)((function(){y(v)}),m),s&&b?Object(r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"crenter",justifyContent:"space-around",height:600},children:[Object(r.jsx)("div",{style:{width:200,height:150,backgroundColor:b[0]?"red":"white"},children:Object(r.jsx)(Re,{dataList:[s[0]]})}),Object(r.jsx)("div",{style:{width:200,height:150,backgroundColor:b[1]?"red":"white"},children:Object(r.jsx)(Re,{dataList:[s[1]]})}),Object(r.jsx)("div",{style:{width:200,height:150,backgroundColor:b[2]?"red":"white"},children:Object(r.jsx)(Re,{dataList:[s[2]]})})]}):Object(r.jsx)("div",{children:"loading..."})},De=function(){var t=Object(l.a)(u.a.mark((function t(e){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.get_result()();case 2:n=t.sent,e(n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ze=function(t){var e=setInterval((function(){De(t)}),200);return function(){clearInterval(e)}};var qe=function(t){var e=t.setMode;return Object(r.jsxs)("div",{class:"row",children:[Object(r.jsx)(He,{setFlagsFunction:Ze}),Object(r.jsx)(Ge,{setFlagsFunction:Ze,setMode:e})]})};var Ke=function(){var t=Object(i.useState)(),e=Object(h.a)(t,2),n=e[0],o=e[1],a=function(){var t=Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.get_mode()();case 2:e=t.sent,console.log("get_mode ok!"),console.log(e),s(e);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),s=function(t){o(t),d.set_args({mode:t})};return Object(i.useEffect)((function(){a()}),[]),Object(i.useEffect)((function(){"init"!==n&&d.start_app()}),[n]),Object(We.a)((function(){"calibration"===n&&a()}),1e3),"init"===n?Object(r.jsx)(v,{setMode:s}):"application"===n?Object(r.jsx)("div",{children:Object(r.jsx)(qe,{setMode:s})}):"calibration"===n?Object(r.jsx)("div",{children:"calibration now..."}):Object(r.jsx)("div",{children:"loading..."})};s.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)("div",{className:"App",children:Object(r.jsx)("header",{className:"App-header",children:Object(r.jsx)(Ke,{})})})}),document.getElementById("root")),c()}},[[46,1,2]]]);
//# sourceMappingURL=main.97d7538a.chunk.js.map